var opened=!0,loadedPercent=10,loadingScreenDiv=window.document.getElementById("loadingScreen"),canvas=(loadingScreenDiv=window.document.getElementById("loadingScreen"),document.getElementById("modelDisplay")),ccontainer=document.getElementById("sossModels"),filesize=5e6;function sossLoadingScreen(){}sossLoadingScreen.prototype.displayLoadingUI=function(){document.getElementById("loadingBar").style.width="0%"},sossLoadingScreen.prototype.hideLoadingUI=function(){loadingScreenDiv.style.opacity=1;var e=window.setInterval((function hideLoadingScreen(){loadingScreenDiv.style.opacity>0&&(loadingScreenDiv.style.opacity-=.05);loadingScreenDiv.style.opacity<=0&&(clearInterval(e),clearInterval(loadingScreenShowTimer),loadingScreenDiv.style.opacity=0,loadingScreenDiv.style.display="none",canvas.width=ccontainer.clientWidth,canvas.height=ccontainer.clientHeight,canvas.style.display="block")}),50)},canvas.addEventListener("contextmenu",(function(e){e.preventDefault()}),!1);var photoCamera,photoCameraB,engine=new BABYLON.Engine(canvas,!0,{premultipliedAlpha:!1,preserveDrawingBuffer:!0,stencil:!0}),scene=new BABYLON.Scene(engine),camera=new BABYLON.ArcRotateCamera("Camera",0,0,30,new BABYLON.Vector3(0,0,0),scene);camera.setTarget(BABYLON.Vector3.Zero());var baseUrl,asyncMesh,currentMesh,shadowGenerator,skyboxPath="public/scene/roomSpecularHDR.dds";scene.clearColor=new BABYLON.Color3(1,1,1);var url=new URL(window.location.href),code=url.searchParams.get("code"),material=url.searchParams.get("material"),createScene=function(){var e=new sossLoadingScreen;return engine.loadingScreen=e,engine.displayLoadingUI(),BABYLON.GLTFFileLoader.IncrementalLoading=!1,baseUrl="public/models/",fileName=code+".glb",BABYLON.SceneLoader.ImportMesh("",baseUrl,fileName,scene,(function(e){scene.createDefaultCameraOrLight(!0,!0,!0),scene.activeCamera.lowerRadiusLimit=500,scene.activeCamera.upperRadiusLimit=2e3,scene.activeCamera.panningSensibility=10,scene.activeCamera.wheelPrecision=.25,scene.activeCamera.useAutoRotationBehavior=!0,setTimeout((function(){scene.activeCamera.useAutoRotationBehavior=!1}),12e3),scene.activeCamera.alpha=Math.PI,scene.activeCamera.beta=1.3,photoCamera=scene.activeCamera.clone(),(photoCameraB=photoCamera.clone()).alpha=Math.PI/3+Math.PI,console.log("Beta: "+scene.activeCamera.beta),new BABYLON.Plane(0,1,0,0).normalize();for(var a=1;a<e.length;a++)scene.beginAnimation(e[a],2.6,2.6,!1),e[a].actionManager=new BABYLON.ActionManager(scene),e[a].actionManager.registerAction(new BABYLON.ExecuteCodeAction(BABYLON.ActionManager.OnPointerOverTrigger,(function(e){}),!1)),e[a].material&&e[a].material.bumpTexture&&(e[a].material.bumpTexture.level=1.5),a>0&&(setBaseColor(e[a]),e[a]._material._roughness=.2,"sn"!=material&&"sc"!=material&&"sb"!=material||setNormal(e[a],"normal_01"),"u"==material&&(setNormal(e[a],"normal_02"),e[a]._material._roughness=.31),101==code&&"bec"==material&&setNormal(e[a],"normal_03"),"orb"==material&&(setNormal(e[a],"normal_04"),e[a]._material._roughness=.31),setAll(e[a]));hdrTexture=new BABYLON.CubeTexture.CreateFromPrefilteredData(skyboxPath,scene),scene.environmentTexture=hdrTexture,engine.hideLoadingUI(),currentMesh=e}),(function(e){if(e.lengthComputable)loadedPercent=100*Math.floor(e.loaded/e.total),e.loaded==e.total&&(loadedPercent=100);else{var a=document.getElementById("loadingBar");(loadedPercent=Math.round(e.loaded/filesize*100))>100&&(loadedPercent=100),a.style.width=loadedPercent+"%",dlCount=e.loaded/1048576,loadedPercent=Math.round(e.loaded/filesize*100),e.loaded==filesize&&(loadedPercent=100)}})),scene};scene=createScene();function setBaseColor(e){var a="public/materials/"+code+"/"+material+"/"+e.name;e._material._albedoTexture=new BABYLON.Texture(a+"_Base_Color.png",scene),e._material._albedoColor.r=1,e._material._albedoColor.g=1,e._material._albedoColor.b=1}function setNormal(e,a){var n="public/materials/"+code+"/"+a+"/"+e.name;e._material._bumpTexture=new BABYLON.Texture(n+"_Normal.png",scene)}function setAll(e){var a="public/materials/"+code+"/all/"+e.name;e._material._metallicTexture=new BABYLON.Texture(a+"_Metallic.png",scene),e._material._ambientTexture=new BABYLON.Texture(a+"_Mixed_AO.png",scene),e._material._ambientTexture=new BABYLON.Texture(a+"_Mixed_AO_A.png",scene)}function menuPlay(){for(var e=1;e<currentMesh.length;e++){var a="public/materials/"+code+"/all/"+currentMesh[e].name;currentMesh[e]._material._ambientTexture=null,opened?(scene.beginAnimation(currentMesh[e],2.6,0,!1),currentMesh[e]._material._ambientTexture=new BABYLON.Texture(a+"_Mixed_AO.png",scene)):(scene.beginAnimation(currentMesh[e],0,2.7,!1),currentMesh[e]._material._ambientTexture=new BABYLON.Texture(a+"_Mixed_AO_A.png",scene))}opened=!opened}engine.runRenderLoop((function(){window.addEventListener("resize",(function(){engine.resize()})),canvas.width=ccontainer.clientWidth,canvas.height=ccontainer.clientHeight,scene.render()}));